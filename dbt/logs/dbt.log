[0m16:49:11.982357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7301f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad97dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad97dc10>]}


============================== 16:49:11.995876 | 0934f739-3cca-4af8-ae29-bb655860cde0 ==============================
[0m16:49:11.995876 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:49:11.997461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models location_character_merge', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:49:12.501107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0934f739-3cca-4af8-ae29-bb655860cde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad955a90>]}
[0m16:49:12.581739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0934f739-3cca-4af8-ae29-bb655860cde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacdb6e20>]}
[0m16:49:12.583035 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m16:49:12.604446 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:49:12.606030 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:49:12.606943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0934f739-3cca-4af8-ae29-bb655860cde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc23ac0>]}
[0m16:49:14.187152 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_tool.example
[0m16:49:14.199457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0934f739-3cca-4af8-ae29-bb655860cde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab836490>]}
[0m16:49:14.225898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0934f739-3cca-4af8-ae29-bb655860cde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc5d220>]}
[0m16:49:14.226624 [info ] [MainThread]: Found 1 model, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:49:14.227773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0934f739-3cca-4af8-ae29-bb655860cde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc23400>]}
[0m16:49:14.231535 [info ] [MainThread]: 
[0m16:49:14.233830 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:49:14.235581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raftai_task'
[0m16:49:14.246459 [debug] [ThreadPool]: Using postgres connection "list_raftai_task"
[0m16:49:14.247009 [debug] [ThreadPool]: On list_raftai_task: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "dbt_tool", "target_name": "dev", "connection_name": "list_raftai_task"} */

    select distinct nspname from pg_namespace
  
[0m16:49:14.247578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:14.299247 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:49:14.304651 [debug] [ThreadPool]: On list_raftai_task: Close
[0m16:49:14.310736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raftai_task, now list_raftai_task_rick_and_morty)
[0m16:49:14.321230 [debug] [ThreadPool]: Using postgres connection "list_raftai_task_rick_and_morty"
[0m16:49:14.326437 [debug] [ThreadPool]: On list_raftai_task_rick_and_morty: BEGIN
[0m16:49:14.327409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:14.337100 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:49:14.338605 [debug] [ThreadPool]: Using postgres connection "list_raftai_task_rick_and_morty"
[0m16:49:14.339144 [debug] [ThreadPool]: On list_raftai_task_rick_and_morty: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "dbt_tool", "target_name": "dev", "connection_name": "list_raftai_task_rick_and_morty"} */
select
      'raftai_task' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'rick_and_morty'
    union all
    select
      'raftai_task' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'rick_and_morty'
    union all
    select
      'raftai_task' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'rick_and_morty'
  
[0m16:49:14.346845 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:49:14.348946 [debug] [ThreadPool]: On list_raftai_task_rick_and_morty: ROLLBACK
[0m16:49:14.350210 [debug] [ThreadPool]: On list_raftai_task_rick_and_morty: Close
[0m16:49:14.364933 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:14.366206 [debug] [MainThread]: On master: BEGIN
[0m16:49:14.367790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:14.412666 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:49:14.414340 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:14.415869 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "dbt_tool", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:49:14.421852 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:49:14.424534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0934f739-3cca-4af8-ae29-bb655860cde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab836c40>]}
[0m16:49:14.425335 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:14.429029 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:14.432213 [debug] [MainThread]: On master: BEGIN
[0m16:49:14.435573 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:49:14.436215 [debug] [MainThread]: On master: COMMIT
[0m16:49:14.436813 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:14.437328 [debug] [MainThread]: On master: COMMIT
[0m16:49:14.438947 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:14.440975 [debug] [MainThread]: On master: Close
[0m16:49:14.442321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:14.445893 [info ] [MainThread]: 
[0m16:49:14.466244 [debug] [Thread-1  ]: Began running node model.raft_dbt.location_character_merge
[0m16:49:14.468012 [info ] [Thread-1  ]: 1 of 1 START sql view model rick_and_morty.location_character_merge ............ [RUN]
[0m16:49:14.470089 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_raftai_task_rick_and_morty, now model.raft_dbt.location_character_merge)
[0m16:49:14.472477 [debug] [Thread-1  ]: Began compiling node model.raft_dbt.location_character_merge
[0m16:49:14.490571 [debug] [Thread-1  ]: Writing injected SQL for node "model.raft_dbt.location_character_merge"
[0m16:49:14.493308 [debug] [Thread-1  ]: Timing info for model.raft_dbt.location_character_merge (compile): 16:49:14.473780 => 16:49:14.493093
[0m16:49:14.493825 [debug] [Thread-1  ]: Began executing node model.raft_dbt.location_character_merge
[0m16:49:14.529835 [debug] [Thread-1  ]: Writing runtime sql for node "model.raft_dbt.location_character_merge"
[0m16:49:14.532325 [debug] [Thread-1  ]: Using postgres connection "model.raft_dbt.location_character_merge"
[0m16:49:14.532828 [debug] [Thread-1  ]: On model.raft_dbt.location_character_merge: BEGIN
[0m16:49:14.533327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:49:14.546531 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:49:14.547995 [debug] [Thread-1  ]: Using postgres connection "model.raft_dbt.location_character_merge"
[0m16:49:14.548968 [debug] [Thread-1  ]: On model.raft_dbt.location_character_merge: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "dbt_tool", "target_name": "dev", "node_id": "model.raft_dbt.location_character_merge"} */

  create view "raftai_task"."rick_and_morty"."location_character_merge__dbt_tmp"
    
    
  as (
    WITH merged_data AS (
    SELECT
            c.id as character_id,
            c.name as character_name,
            c.status as character_status,
            c.species as character_species,
            c.type as character_type,
            c.gender as character_gender,
            c.image as character_image,
            c.episode as character_episode,
            c.url as character_url,
            c.created as character_created,
            l.id as location_id,
            l.name as location_name,
            l.type as location_type,
            l.dimension as location_dimension,
            l.url as location_url,
            l.created as location_created
    FROM "raftai_task"."rick_and_morty"."characters" c
    LEFT JOIN "raftai_task"."rick_and_morty"."locations" l ON c.location_id = l.id
)

SELECT * FROM merged_data
  );
[0m16:49:14.566635 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:49:14.576895 [debug] [Thread-1  ]: Using postgres connection "model.raft_dbt.location_character_merge"
[0m16:49:14.577951 [debug] [Thread-1  ]: On model.raft_dbt.location_character_merge: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "dbt_tool", "target_name": "dev", "node_id": "model.raft_dbt.location_character_merge"} */
alter table "raftai_task"."rick_and_morty"."location_character_merge__dbt_tmp" rename to "location_character_merge"
[0m16:49:14.579654 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:14.597358 [debug] [Thread-1  ]: On model.raft_dbt.location_character_merge: COMMIT
[0m16:49:14.598103 [debug] [Thread-1  ]: Using postgres connection "model.raft_dbt.location_character_merge"
[0m16:49:14.598572 [debug] [Thread-1  ]: On model.raft_dbt.location_character_merge: COMMIT
[0m16:49:14.600185 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:49:14.606324 [debug] [Thread-1  ]: Applying DROP to: "raftai_task"."rick_and_morty"."location_character_merge__dbt_backup"
[0m16:49:14.612348 [debug] [Thread-1  ]: Using postgres connection "model.raft_dbt.location_character_merge"
[0m16:49:14.613051 [debug] [Thread-1  ]: On model.raft_dbt.location_character_merge: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "dbt_tool", "target_name": "dev", "node_id": "model.raft_dbt.location_character_merge"} */
drop view if exists "raftai_task"."rick_and_morty"."location_character_merge__dbt_backup" cascade
[0m16:49:14.615080 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:49:14.617323 [debug] [Thread-1  ]: Timing info for model.raft_dbt.location_character_merge (execute): 16:49:14.494193 => 16:49:14.617035
[0m16:49:14.618012 [debug] [Thread-1  ]: On model.raft_dbt.location_character_merge: Close
[0m16:49:14.619500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0934f739-3cca-4af8-ae29-bb655860cde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab7d98b0>]}
[0m16:49:14.621589 [info ] [Thread-1  ]: 1 of 1 OK created sql view model rick_and_morty.location_character_merge ....... [[32mCREATE VIEW[0m in 0.15s]
[0m16:49:14.625289 [debug] [Thread-1  ]: Finished running node model.raft_dbt.location_character_merge
[0m16:49:14.628972 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:14.629673 [debug] [MainThread]: On master: BEGIN
[0m16:49:14.630512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:14.655197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:49:14.658456 [debug] [MainThread]: On master: COMMIT
[0m16:49:14.666194 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:14.676494 [debug] [MainThread]: On master: COMMIT
[0m16:49:14.688353 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:14.691783 [debug] [MainThread]: On master: Close
[0m16:49:14.697104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:14.703206 [debug] [MainThread]: Connection 'model.raft_dbt.location_character_merge' was properly closed.
[0m16:49:14.705810 [info ] [MainThread]: 
[0m16:49:14.709875 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m16:49:14.715757 [debug] [MainThread]: Command end result
[0m16:49:14.746403 [info ] [MainThread]: 
[0m16:49:14.748878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:14.750212 [info ] [MainThread]: 
[0m16:49:14.755176 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:49:14.764099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8969088, "process_user_time": 6.320937, "process_kernel_time": 1.054401, "process_mem_max_rss": "107548", "process_in_blocks": "103752", "process_out_blocks": "856"}
[0m16:49:14.768031 [debug] [MainThread]: Command `dbt run` succeeded at 16:49:14.767762 after 2.90 seconds
[0m16:49:14.769324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7301f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab8362e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc5d220>]}
[0m16:49:14.770090 [debug] [MainThread]: Flushing usage events
[0m16:49:14.971941 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
